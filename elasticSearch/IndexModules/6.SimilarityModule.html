<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>SimilarityModule</title>


        <!-- Custom HTML head -->
        
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../../index.html">数据存储</a></li><li class="chapter-item expanded affix "><li class="part-title"></li><li class="chapter-item expanded "><div><strong aria-hidden="true">1.</strong> oracle</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../oracle/Oracle小知识点.html"><strong aria-hidden="true">1.1.</strong> Oracle小知识点</a></li><li class="chapter-item expanded "><a href="../../oracle/oracledocker快速搭建.html"><strong aria-hidden="true">1.2.</strong> oracledocker快速搭建</a></li><li class="chapter-item expanded "><a href="../../oracle/oracle多表更新方法.html"><strong aria-hidden="true">1.3.</strong> oracle多表更新方法</a></li></ol></li><li class="chapter-item expanded "><a href="../../MongoDB/index.html"><strong aria-hidden="true">2.</strong> MongoDB</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../MongoDB/mongodb基本操作.html"><strong aria-hidden="true">2.1.</strong> mongodb基本操作</a></li><li class="chapter-item expanded "><a href="../../MongoDB/mongodb高级语法.html"><strong aria-hidden="true">2.2.</strong> mongodb高级语法</a></li><li class="chapter-item expanded "><a href="../../MongoDB/权限管理.html"><strong aria-hidden="true">2.3.</strong> 权限管理</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.</strong> mysql</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../mysql/mysqlfunction.html"><strong aria-hidden="true">3.1.</strong> mysqlfunction</a></li><li class="chapter-item expanded "><a href="../../mysql/mysqlpdump.html"><strong aria-hidden="true">3.2.</strong> mysqlpdump</a></li><li class="chapter-item expanded "><a href="../../mysql/mysqlzip安装.html"><strong aria-hidden="true">3.3.</strong> mysqlzip安装</a></li><li class="chapter-item expanded "><a href="../../mysql/mysql公用表达式.html"><strong aria-hidden="true">3.4.</strong> mysql公用表达式</a></li><li class="chapter-item expanded "><a href="../../mysql/mysql学习.html"><strong aria-hidden="true">3.5.</strong> mysql学习</a></li><li class="chapter-item expanded "><a href="../../mysql/mysql执行计划.html"><strong aria-hidden="true">3.6.</strong> mysql执行计划</a></li><li class="chapter-item expanded "><a href="../../mysql/空值处理函数.html"><strong aria-hidden="true">3.7.</strong> 空值处理函数</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.8.</strong> mysql官方文档</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../mysql/mysql官方文档/mysql程序.html"><strong aria-hidden="true">3.8.1.</strong> mysql程序</a></li><li class="chapter-item expanded "><a href="../../mysql/mysql官方文档/客户端.html"><strong aria-hidden="true">3.8.2.</strong> 客户端</a></li><li class="chapter-item expanded "><a href="../../mysql/mysql官方文档/mysql程序/index.html"><strong aria-hidden="true">3.8.3.</strong> mysql程序</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../mysql/mysql官方文档/mysql程序/使用mysql相关程序.html"><strong aria-hidden="true">3.8.3.1.</strong> 使用mysql相关程序</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../../mysql/mysql日志/index.html"><strong aria-hidden="true">3.9.</strong> mysql日志</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../mysql/mysql日志/mysql日志及分类.html"><strong aria-hidden="true">3.9.1.</strong> mysql日志及分类</a></li><li class="chapter-item expanded "><a href="../../mysql/mysql日志/二进制日志.html"><strong aria-hidden="true">3.9.2.</strong> 二进制日志</a></li><li class="chapter-item expanded "><a href="../../mysql/mysql日志/慢sql日志.html"><strong aria-hidden="true">3.9.3.</strong> 慢sql日志</a></li><li class="chapter-item expanded "><a href="../../mysql/mysql日志/通用日志.html"><strong aria-hidden="true">3.9.4.</strong> 通用日志</a></li><li class="chapter-item expanded "><a href="../../mysql/mysql日志/错误日志.html"><strong aria-hidden="true">3.9.5.</strong> 错误日志</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../../elasticSearch/index.html"><strong aria-hidden="true">4.</strong> elasticSearch</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../elasticSearch/BackUpACluster.html"><strong aria-hidden="true">4.1.</strong> BackUpACluster</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/KQL.html"><strong aria-hidden="true">4.2.</strong> KQL</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/dataStream.html"><strong aria-hidden="true">4.3.</strong> dataStream</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/es堆内存如何分配.html"><strong aria-hidden="true">4.4.</strong> es堆内存如何分配</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/scroll查询.html"><strong aria-hidden="true">4.5.</strong> scroll查询</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/乐观并发控制.html"><strong aria-hidden="true">4.6.</strong> 乐观并发控制</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/分布式检索.html"><strong aria-hidden="true">4.7.</strong> 分布式检索</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/分片内部原理.html"><strong aria-hidden="true">4.8.</strong> 分片内部原理</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/分词.html"><strong aria-hidden="true">4.9.</strong> 分词</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/前缀搜索与模糊搜索.html"><strong aria-hidden="true">4.10.</strong> 前缀搜索与模糊搜索</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/数据分片.html"><strong aria-hidden="true">4.11.</strong> 数据分片</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/映射.html"><strong aria-hidden="true">4.12.</strong> 映射</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/杂项学习.html"><strong aria-hidden="true">4.13.</strong> 杂项学习</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/索引和分片.html"><strong aria-hidden="true">4.14.</strong> 索引和分片</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/索引管理.html"><strong aria-hidden="true">4.15.</strong> 索引管理</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/评分标准与相关性.html"><strong aria-hidden="true">4.16.</strong> 评分标准与相关性</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/集群内原理.html"><strong aria-hidden="true">4.17.</strong> 集群内原理</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/Datamanagement/index.html"><strong aria-hidden="true">4.18.</strong> Datamanagement</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../elasticSearch/Datamanagement/DataTier.html"><strong aria-hidden="true">4.18.1.</strong> DataTier</a></li></ol></li><li class="chapter-item expanded "><a href="../../elasticSearch/ILM/index.html"><strong aria-hidden="true">4.19.</strong> ILM</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../elasticSearch/ILM/1.AutomateRolloverWithILM.html"><strong aria-hidden="true">4.19.1.</strong> AutomateRolloverWithILM</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/ILM/FrozenIndices.html"><strong aria-hidden="true">4.19.2.</strong> FrozenIndices</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/ILM/ILM.html"><strong aria-hidden="true">4.19.3.</strong> ILM</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/ILM/RolloverAPI.html"><strong aria-hidden="true">4.19.4.</strong> RolloverAPI</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/ILM/ShrinkIndexAPI.html"><strong aria-hidden="true">4.19.5.</strong> ShrinkIndexAPI</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/ILM/ILMConcepts/index.html"><strong aria-hidden="true">4.19.6.</strong> ILMConcepts</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../elasticSearch/ILM/ILMConcepts/1.Rollover.html"><strong aria-hidden="true">4.19.6.1.</strong> Rollover</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/ILM/ILMConcepts/2.LifeCycleUpdates.html"><strong aria-hidden="true">4.19.6.2.</strong> LifeCycleUpdates</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../../elasticSearch/IndexModules/index.html"><strong aria-hidden="true">4.20.</strong> IndexModules</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../elasticSearch/IndexModules/1.Analysis.html"><strong aria-hidden="true">4.20.1.</strong> Analysis</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/IndexModules/2.IndexShardAllocation.html"><strong aria-hidden="true">4.20.2.</strong> IndexShardAllocation</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/IndexModules/3.Indexblocks.html"><strong aria-hidden="true">4.20.3.</strong> Indexblocks</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/IndexModules/4.Mapper.html"><strong aria-hidden="true">4.20.4.</strong> Mapper</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/IndexModules/5.Merge.html"><strong aria-hidden="true">4.20.5.</strong> Merge</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/IndexModules/6.SimilarityModule.html" class="active"><strong aria-hidden="true">4.20.6.</strong> SimilarityModule</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/IndexModules/7.Slowlog.html"><strong aria-hidden="true">4.20.7.</strong> Slowlog</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/IndexModules/8.Store.html"><strong aria-hidden="true">4.20.8.</strong> Store</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/IndexModules/9.Translog.html"><strong aria-hidden="true">4.20.9.</strong> Translog</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/IndexModules/10.HistoryRetention.html"><strong aria-hidden="true">4.20.10.</strong> HistoryRetention</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/IndexModules/11.IndexSorting.html"><strong aria-hidden="true">4.20.11.</strong> IndexSorting</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/IndexModules/12.IndexPressure.html"><strong aria-hidden="true">4.20.12.</strong> IndexPressure</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">4.21.</strong> IngestPipeline</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../elasticSearch/IngestPipeline/1.IngestPipelines.html"><strong aria-hidden="true">4.21.1.</strong> IngestPipelines</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/IngestPipeline/2.pipeLineExample.html"><strong aria-hidden="true">4.21.2.</strong> pipeLineExample</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/IngestPipeline/3.EnrichYourData.html"><strong aria-hidden="true">4.21.3.</strong> EnrichYourData</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/IngestPipeline/4.ExampleEnrichYourDataBasedOnGeolocation.html"><strong aria-hidden="true">4.21.4.</strong> ExampleEnrichYourDataBasedOnGeolocation</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/IngestPipeline/5.IngestProcessorReference.html"><strong aria-hidden="true">4.21.5.</strong> IngestProcessorReference</a></li></ol></li><li class="chapter-item expanded "><a href="../../elasticSearch/queryDSL/index.html"><strong aria-hidden="true">4.22.</strong> queryDSL</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../elasticSearch/queryDSL/1.QueryAndFilterContext.html"><strong aria-hidden="true">4.22.1.</strong> QueryAndFilterContext</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/queryDSL/2.CompoundQueries.html"><strong aria-hidden="true">4.22.2.</strong> CompoundQueries</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/queryDSL/SearchAfter.html"><strong aria-hidden="true">4.22.3.</strong> SearchAfter</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/queryDSL/FullTextQueries/index.html"><strong aria-hidden="true">4.22.4.</strong> FullTextQueries</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../elasticSearch/queryDSL/FullTextQueries/1.IntervalsQuery.html"><strong aria-hidden="true">4.22.4.1.</strong> IntervalsQuery</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/queryDSL/FullTextQueries/2.MatchQuery.html"><strong aria-hidden="true">4.22.4.2.</strong> MatchQuery</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../../elasticSearch/snapshotAndRestore/index.html"><strong aria-hidden="true">4.23.</strong> snapshotAndRestore</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../elasticSearch/snapshotAndRestore/CleanUpSnapshotRepo.html"><strong aria-hidden="true">4.23.1.</strong> CleanUpSnapshotRepo</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/snapshotAndRestore/CloneSnapshot.html"><strong aria-hidden="true">4.23.2.</strong> CloneSnapshot</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/snapshotAndRestore/CreateOrUpdateSnapshotAPI.html"><strong aria-hidden="true">4.23.3.</strong> CreateOrUpdateSnapshotAPI</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/snapshotAndRestore/CreateSnapshot.html"><strong aria-hidden="true">4.23.4.</strong> CreateSnapshot</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/snapshotAndRestore/DeleteSnapShot.html"><strong aria-hidden="true">4.23.5.</strong> DeleteSnapShot</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/snapshotAndRestore/DeleteSnapshotRepository.html"><strong aria-hidden="true">4.23.6.</strong> DeleteSnapshotRepository</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/snapshotAndRestore/GetSnapshotAPI.html"><strong aria-hidden="true">4.23.7.</strong> GetSnapshotAPI</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/snapshotAndRestore/RegisterASnapshot.html"><strong aria-hidden="true">4.23.8.</strong> RegisterASnapshot</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/snapshotAndRestore/RestoreSnapshot.html"><strong aria-hidden="true">4.23.9.</strong> RestoreSnapshot</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/snapshotAndRestore/SLM.html"><strong aria-hidden="true">4.23.10.</strong> SLM</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/snapshotAndRestore/SearchableSnapshots.html"><strong aria-hidden="true">4.23.11.</strong> SearchableSnapshots</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/snapshotAndRestore/SearchableSnapshotsMountAPI.html"><strong aria-hidden="true">4.23.12.</strong> SearchableSnapshotsMountAPI</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/snapshotAndRestore/repository-s3.html"><strong aria-hidden="true">4.23.13.</strong> repository-s3</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/snapshotAndRestore/使用OSS备份恢复集群实战.html"><strong aria-hidden="true">4.23.14.</strong> 使用OSS备份恢复集群实战</a></li></ol></li><li class="chapter-item expanded "><a href="../../elasticSearch/安装/index.html"><strong aria-hidden="true">4.24.</strong> 安装</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../elasticSearch/安装/1.InstallingFromRpm.html"><strong aria-hidden="true">4.24.1.</strong> InstallingFromRpm</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/安装/2.InstallFromDeb.html"><strong aria-hidden="true">4.24.2.</strong> InstallFromDeb</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">4.25.</strong> 深入搜索</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../elasticSearch/深入搜索/全文搜索.html"><strong aria-hidden="true">4.25.1.</strong> 全文搜索</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/深入搜索/多字段搜索.html"><strong aria-hidden="true">4.25.2.</strong> 多字段搜索</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/深入搜索/结构化搜索.html"><strong aria-hidden="true">4.25.3.</strong> 结构化搜索</a></li></ol></li><li class="chapter-item expanded "><a href="../../elasticSearch/索引分片分配/index.html"><strong aria-hidden="true">4.26.</strong> 索引分片分配</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../elasticSearch/索引分片分配/1.索引级别的分片分配控制.html"><strong aria-hidden="true">4.26.1.</strong> 索引级别的分片分配控制</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/索引分片分配/2.节点离开延迟分配.html"><strong aria-hidden="true">4.26.2.</strong> 节点离开延迟分配</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/索引分片分配/3.索引恢复优先级.html"><strong aria-hidden="true">4.26.3.</strong> 索引恢复优先级</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/索引分片分配/4.每个节点的总分片.html"><strong aria-hidden="true">4.26.4.</strong> 每个节点的总分片</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/索引分片分配/5.索引级别数据层分配过滤.html"><strong aria-hidden="true">4.26.5.</strong> 索引级别数据层分配过滤</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/索引分片分配/6.手动分配分片clusterRerouteAPI.html"><strong aria-hidden="true">4.26.6.</strong> 手动分配分片clusterRerouteAPI</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/索引分片分配/7.cluster-allocation-explain.html"><strong aria-hidden="true">4.26.7.</strong> cluster-allocation-explain</a></li></ol></li><li class="chapter-item expanded "><a href="../../elasticSearch/考纲解读/index.html"><strong aria-hidden="true">4.27.</strong> 考纲解读</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../elasticSearch/考纲解读/1.ClusterManagement.html"><strong aria-hidden="true">4.27.1.</strong> ClusterManagement</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/考纲解读/2.DataManagement.html"><strong aria-hidden="true">4.27.2.</strong> DataManagement</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">4.28.</strong> 聚合</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../elasticSearch/聚合/RareTermsAggregation.html"><strong aria-hidden="true">4.28.1.</strong> RareTermsAggregation</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/聚合/Term.html"><strong aria-hidden="true">4.28.2.</strong> Term</a></li></ol></li><li class="chapter-item expanded "><a href="../../elasticSearch/配置/index.html"><strong aria-hidden="true">4.29.</strong> 配置</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../elasticSearch/配置/1.重要配置.html"><strong aria-hidden="true">4.29.1.</strong> 重要配置</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/配置/2.elasticsearch.yml核心配置.html"><strong aria-hidden="true">4.29.2.</strong> elasticsearch.yml核心配置</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/配置/3.es系统参数修改.html"><strong aria-hidden="true">4.29.3.</strong> es系统参数修改</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">4.30.</strong> 集群</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../elasticSearch/集群/Health.html"><strong aria-hidden="true">4.30.1.</strong> Health</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">4.31.</strong> 高可用专题</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../elasticSearch/高可用专题/弹性设计.html"><strong aria-hidden="true">4.31.1.</strong> 弹性设计</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/高可用专题/跨集群复制.html"><strong aria-hidden="true">4.31.2.</strong> 跨集群复制</a></li><li class="chapter-item expanded "><a href="../../elasticSearch/高可用专题/集群备份.html"><strong aria-hidden="true">4.31.3.</strong> 集群备份</a></li></ol></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h2 id="similarity-module"><a class="header" href="#similarity-module">Similarity module</a></h2>
<ol>
<li>
<p>相似性 (评分/排名模型) 定义了匹配文档的评分方式。</p>
</li>
<li>
<p>相似性是每个字段，这意味着通过 <code>mapping</code> 可以定义每个字段的不同相似性。</p>
</li>
<li>
<p>配置自定义相似性是 expert feature  ，并且内置相似性很可能就足够了，如 <a href="https://www.elastic.co/guide/en/elasticsearch/reference/7.13/similarity.html"><code>similarity</code></a>. 中所述。</p>
</li>
</ol>
<h3 id="configuring-a-similarity"><a class="header" href="#configuring-a-similarity">Configuring a similarity</a></h3>
<ol>
<li>
<p>大多数现有或自定义相似性都具有配置选项，可以通过索引设置进行配置，如下所示</p>
</li>
<li>
<p>创建索引或更新索引设置时可以提供索引选项。</p>
</li>
</ol>
<pre><code class="language-console">PUT /index
{
  &quot;settings&quot;: {
    &quot;index&quot;: {
      &quot;similarity&quot;: {
        &quot;my_similarity&quot;: {
          &quot;type&quot;: &quot;DFR&quot;,
          &quot;basic_model&quot;: &quot;g&quot;,
          &quot;after_effect&quot;: &quot;l&quot;,
          &quot;normalization&quot;: &quot;h2&quot;,
          &quot;normalization.h2.c&quot;: &quot;3.0&quot;
        }
      }
    }
  }
}
</code></pre>
<p>在这里，我们配置DFR相似性，以便可以在映射中引用为my_simility，如下面的示例所示:</p>
<pre><code class="language-console">PUT /index/_mapping
{
  &quot;properties&quot; : {
    &quot;title&quot; : { &quot;type&quot; : &quot;text&quot;, &quot;similarity&quot; : &quot;my_similarity&quot; }
  }
}
</code></pre>
<h3 id="available-similarities"><a class="header" href="#available-similarities">Available similarities</a></h3>
<h4 id="bm25-similarity-default"><a class="header" href="#bm25-similarity-default">BM25 similarity (<strong>default</strong>)</a></h4>
<p>基于TF/IDF的相似性，具有内置的tf归一化，并且对短字段 (如名称) 更好地工作。See <a href="https://en.wikipedia.org/wiki/Okapi_BM25">Okapi_BM25</a> for more details.</p>
<p>这种相似性有以下选项:</p>
<table><thead><tr><th></th><th></th></tr></thead><tbody>
<tr><td><code>k1</code></td><td>Controls non-linear term frequency normalization (saturation). The default value is <code>1.2</code>.</td></tr>
<tr><td><code>b</code></td><td>Controls to what degree document length normalizes tf values. The default value is <code>0.75</code>.</td></tr>
<tr><td><code>discount_overlaps</code></td><td>Determines whether overlap tokens (Tokens with 0 position increment) are ignored when computing norm. By default this is true, meaning overlap tokens do not count when computing norms.</td></tr>
</tbody></table>
<h4 id="dfr-similarity"><a class="header" href="#dfr-similarity">DFR similarity</a></h4>
<p>Similarity that implements the <a href="https://lucene.apache.org/core/8_8_2/core/org/apache/lucene/search/similarities/DFRSimilarity.html">divergence from randomness</a> framework. This similarity has the following options:</p>
<table><thead><tr><th></th><th></th></tr></thead><tbody>
<tr><td><code>basic_model</code></td><td>Possible values: <a href="https://lucene.apache.org/core/8_8_2/core/org/apache/lucene/search/similarities/BasicModelG.html"><code>g</code></a>, <a href="https://lucene.apache.org/core/8_8_2/core/org/apache/lucene/search/similarities/BasicModelIF.html"><code>if</code></a>, <a href="https://lucene.apache.org/core/8_8_2/core/org/apache/lucene/search/similarities/BasicModelIn.html"><code>in</code></a> and <a href="https://lucene.apache.org/core/8_8_2/core/org/apache/lucene/search/similarities/BasicModelIne.html"><code>ine</code></a>.</td></tr>
<tr><td><code>after_effect</code></td><td>Possible values: <a href="https://lucene.apache.org/core/8_8_2/core/org/apache/lucene/search/similarities/AfterEffectB.html"><code>b</code></a> and <a href="https://lucene.apache.org/core/8_8_2/core/org/apache/lucene/search/similarities/AfterEffectL.html"><code>l</code></a>.</td></tr>
<tr><td><code>normalization</code></td><td>Possible values: <a href="https://lucene.apache.org/core/8_8_2/core/org/apache/lucene/search/similarities/Normalization.NoNormalization.html"><code>no</code></a>, <a href="https://lucene.apache.org/core/8_8_2/core/org/apache/lucene/search/similarities/NormalizationH1.html"><code>h1</code></a>, <a href="https://lucene.apache.org/core/8_8_2/core/org/apache/lucene/search/similarities/NormalizationH2.html"><code>h2</code></a>, <a href="https://lucene.apache.org/core/8_8_2/core/org/apache/lucene/search/similarities/NormalizationH3.html"><code>h3</code></a> and <a href="https://lucene.apache.org/core/8_8_2/core/org/apache/lucene/search/similarities/NormalizationZ.html"><code>z</code></a>.</td></tr>
</tbody></table>
<p>All options but the first option need a normalization value.</p>
<p>Type name: <code>DFR</code></p>
<h4 id="dfi-similarity"><a class="header" href="#dfi-similarity">DFI similarity</a></h4>
<p>Similarity that implements the <a href="https://trec.nist.gov/pubs/trec21/papers/irra.web.nb.pdf">divergence from independence</a> model. This similarity has the following options:</p>
<p><code>independence_measure</code>  Possible values <a href="https://lucene.apache.org/core/8_8_2/core/org/apache/lucene/search/similarities/IndependenceStandardized.html"><code>standardized</code></a>, <a href="https://lucene.apache.org/core/8_8_2/core/org/apache/lucene/search/similarities/IndependenceSaturated.html"><code>saturated</code></a>, <a href="https://lucene.apache.org/core/8_8_2/core/org/apache/lucene/search/similarities/IndependenceChiSquared.html"><code>chisquared</code></a>.</p>
<p>When using this similarity, it is highly recommended <strong>not</strong> to remove stop words to get good relevance. Also beware that terms whose frequency is less than the expected frequency will get a score equal to 0.</p>
<p>Type name: <code>DFI</code></p>
<h4 id="ib-similarity"><a class="header" href="#ib-similarity">IB similarity.</a></h4>
<p><a href="https://lucene.apache.org/core/8_8_2/core/org/apache/lucene/search/similarities/IBSimilarity.html">Information based model</a> . The algorithm is based on the concept that the information content in any symbolic <em>distribution</em> sequence is primarily determined by the repetitive usage of its basic elements. For written texts this challenge would correspond to comparing the writing styles of different authors. This similarity has the following options:</p>
<table><thead><tr><th></th><th></th></tr></thead><tbody>
<tr><td><code>distribution</code></td><td>Possible values: <a href="https://lucene.apache.org/core/8_8_2/core/org/apache/lucene/search/similarities/DistributionLL.html"><code>ll</code></a> and <a href="https://lucene.apache.org/core/8_8_2/core/org/apache/lucene/search/similarities/DistributionSPL.html"><code>spl</code></a>.</td></tr>
<tr><td><code>lambda</code></td><td>Possible values: <a href="https://lucene.apache.org/core/8_8_2/core/org/apache/lucene/search/similarities/LambdaDF.html"><code>df</code></a> and <a href="https://lucene.apache.org/core/8_8_2/core/org/apache/lucene/search/similarities/LambdaTTF.html"><code>ttf</code></a>.</td></tr>
<tr><td><code>normalization</code></td><td>Same as in <code>DFR</code> similarity.</td></tr>
</tbody></table>
<p>Type name: <code>IB</code></p>
<h4 id="lm-dirichlet-similarity"><a class="header" href="#lm-dirichlet-similarity">LM Dirichlet similarity.</a></h4>
<p><a href="https://lucene.apache.org/core/8_8_2/core/org/apache/lucene/search/similarities/LMDirichletSimilarity.html">LM Dirichlet similarity</a> . This similarity has the following options:</p>
<table><thead><tr><th></th><th></th></tr></thead><tbody>
<tr><td><code>mu</code></td><td>Default to <code>2000</code>.</td></tr>
</tbody></table>
<p>The scoring formula in the paper assigns negative scores to terms that have fewer occurrences than predicted by the language model, which is illegal to Lucene, so such terms get a score of 0.</p>
<p>Type name: <code>LMDirichlet</code></p>
<h4 id="lm-jelinek-mercer-similarity"><a class="header" href="#lm-jelinek-mercer-similarity">LM Jelinek Mercer similarity.</a></h4>
<p><a href="https://lucene.apache.org/core/8_8_2/core/org/apache/lucene/search/similarities/LMJelinekMercerSimilarity.html">LM Jelinek Mercer similarity</a> . The algorithm attempts to capture important patterns in the text, while leaving out noise. This similarity has the following options:</p>
<table><thead><tr><th></th><th></th></tr></thead><tbody>
<tr><td><code>lambda</code></td><td>The optimal value depends on both the collection and the query. The optimal value is around <code>0.1</code> for title queries and <code>0.7</code> for long queries. Default to <code>0.1</code>. When value approaches <code>0</code>, documents that match more query terms will be ranked higher than those that match fewer terms.</td></tr>
</tbody></table>
<p>Type name: <code>LMJelinekMercer</code></p>
<h4 id="scripted-similarity"><a class="header" href="#scripted-similarity">Scripted similarity</a></h4>
<p>一种相似性，允许您使用脚本来指定应如何计算分数。</p>
<p>例如，下面的示例显示了如何重新实现tf-idf:</p>
<pre><code class="language-console">PUT /index
{
  &quot;settings&quot;: {
    &quot;number_of_shards&quot;: 1,
    &quot;similarity&quot;: {
      &quot;scripted_tfidf&quot;: {
        &quot;type&quot;: &quot;scripted&quot;,
        &quot;script&quot;: {
          &quot;source&quot;: &quot;double tf = Math.sqrt(doc.freq); double idf = Math.log((field.docCount+1.0)/(term.docFreq+1.0)) + 1.0; double norm = 1/Math.sqrt(doc.length); return query.boost * tf * idf * norm;&quot;
        }
      }
    }
  },
  &quot;mappings&quot;: {
    &quot;properties&quot;: {
      &quot;field&quot;: {
        &quot;type&quot;: &quot;text&quot;,
        &quot;similarity&quot;: &quot;scripted_tfidf&quot;
      }
    }
  }
}

PUT /index/_doc/1
{
  &quot;field&quot;: &quot;foo bar foo&quot;
}

PUT /index/_doc/2
{
  &quot;field&quot;: &quot;bar baz&quot;
}

POST /index/_refresh

GET /index/_search?explain=true
{
  &quot;query&quot;: {
    &quot;query_string&quot;: {
      &quot;query&quot;: &quot;foo^1.7&quot;,
      &quot;default_field&quot;: &quot;field&quot;
    }
  }
}
</code></pre>
<pre><code class="language-console-result">{
  &quot;took&quot;: 12,
  &quot;timed_out&quot;: false,
  &quot;_shards&quot;: {
    &quot;total&quot;: 1,
    &quot;successful&quot;: 1,
    &quot;skipped&quot;: 0,
    &quot;failed&quot;: 0
  },
  &quot;hits&quot;: {
    &quot;total&quot;: {
        &quot;value&quot;: 1,
        &quot;relation&quot;: &quot;eq&quot;
    },
    &quot;max_score&quot;: 1.9508477,
    &quot;hits&quot;: [
      {
        &quot;_shard&quot;: &quot;[index][0]&quot;,
        &quot;_node&quot;: &quot;OzrdjxNtQGaqs4DmioFw9A&quot;,
        &quot;_index&quot;: &quot;index&quot;,
        &quot;_type&quot;: &quot;_doc&quot;,
        &quot;_id&quot;: &quot;1&quot;,
        &quot;_score&quot;: 1.9508477,
        &quot;_source&quot;: {
          &quot;field&quot;: &quot;foo bar foo&quot;
        },
        &quot;_explanation&quot;: {
          &quot;value&quot;: 1.9508477,
          &quot;description&quot;: &quot;weight(field:foo in 0) [PerFieldSimilarity], result of:&quot;,
          &quot;details&quot;: [
            {
              &quot;value&quot;: 1.9508477,
              &quot;description&quot;: &quot;score from ScriptedSimilarity(weightScript=[null], script=[Script{type=inline, lang='painless', idOrCode='double tf = Math.sqrt(doc.freq); double idf = Math.log((field.docCount+1.0)/(term.docFreq+1.0)) + 1.0; double norm = 1/Math.sqrt(doc.length); return query.boost * tf * idf * norm;', options={}, params={}}]) computed from:&quot;,
              &quot;details&quot;: [
                {
                  &quot;value&quot;: 1.0,
                  &quot;description&quot;: &quot;weight&quot;,
                  &quot;details&quot;: []
                },
                {
                  &quot;value&quot;: 1.7,
                  &quot;description&quot;: &quot;query.boost&quot;,
                  &quot;details&quot;: []
                },
                {
                  &quot;value&quot;: 2,
                  &quot;description&quot;: &quot;field.docCount&quot;,
                  &quot;details&quot;: []
                },
                {
                  &quot;value&quot;: 4,
                  &quot;description&quot;: &quot;field.sumDocFreq&quot;,
                  &quot;details&quot;: []
                },
                {
                  &quot;value&quot;: 5,
                  &quot;description&quot;: &quot;field.sumTotalTermFreq&quot;,
                  &quot;details&quot;: []
                },
                {
                  &quot;value&quot;: 1,
                  &quot;description&quot;: &quot;term.docFreq&quot;,
                  &quot;details&quot;: []
                },
                {
                  &quot;value&quot;: 2,
                  &quot;description&quot;: &quot;term.totalTermFreq&quot;,
                  &quot;details&quot;: []
                },
                {
                  &quot;value&quot;: 2.0,
                  &quot;description&quot;: &quot;doc.freq&quot;,
                  &quot;details&quot;: []
                },
                {
                  &quot;value&quot;: 3,
                  &quot;description&quot;: &quot;doc.length&quot;,
                  &quot;details&quot;: []
                }
              ]
            }
          ]
        }
      }
    ]
  }
}
</code></pre>
<p>While scripted similarities provide a lot of flexibility, there is a set of rules that they need to satisfy. Failing to do so could make Elasticsearch silently return wrong top hits or fail with internal errors at search time:</p>
<ul>
<li>Returned scores must be positive.</li>
<li>All other variables remaining equal, scores must not decrease when <code>doc.freq</code> increases.</li>
<li>All other variables remaining equal, scores must not increase when <code>doc.length</code> increases.</li>
</ul>
<p>It is possible to make the above slightly more efficient by providing an <code>weight_script</code> which will compute the document-independent part of the score and will be available under the <code>weight</code> variable. When no <code>weight_script</code> is provided, <code>weight</code> is equal to <code>1</code>. The <code>weight_script</code> has access to the same variables as the <code>script</code> except <code>doc</code> since it is supposed to compute a document-independent contribution to the score.</p>
<p>The below configuration will give the same tf-idf scores but is slightly more efficient:</p>
<pre><code>PUT /index
{
  &quot;settings&quot;: {
    &quot;number_of_shards&quot;: 1,
    &quot;similarity&quot;: {
      &quot;scripted_tfidf&quot;: {
        &quot;type&quot;: &quot;scripted&quot;,
        &quot;weight_script&quot;: {
          &quot;source&quot;: &quot;double idf = Math.log((field.docCount+1.0)/(term.docFreq+1.0)) + 1.0; return query.boost * idf;&quot;
        },
        &quot;script&quot;: {
          &quot;source&quot;: &quot;double tf = Math.sqrt(doc.freq); double norm = 1/Math.sqrt(doc.length); return weight * tf * norm;&quot;
        }
      }
    }
  },
  &quot;mappings&quot;: {
    &quot;properties&quot;: {
      &quot;field&quot;: {
        &quot;type&quot;: &quot;text&quot;,
        &quot;similarity&quot;: &quot;scripted_tfidf&quot;
      }
    }
  }
}
</code></pre>
<h4 id="default-similarity"><a class="header" href="#default-similarity">Default Similarity</a></h4>
<p>By default, Elasticsearch will use whatever similarity is configured as <code>default</code>.</p>
<p>You can change the default similarity for all fields in an index when it is <a href="https://www.elastic.co/guide/en/elasticsearch/reference/7.13/indices-create-index.html">created</a>:</p>
<pre><code class="language-console">PUT /index
{
  &quot;settings&quot;: {
    &quot;index&quot;: {
      &quot;similarity&quot;: {
        &quot;default&quot;: {
          &quot;type&quot;: &quot;boolean&quot;
        }
      }
    }
  }
}
</code></pre>
<p>If you want to change the default similarity after creating the index you must <a href="https://www.elastic.co/guide/en/elasticsearch/reference/7.13/indices-open-close.html">close</a> your index, send the following request and <a href="https://www.elastic.co/guide/en/elasticsearch/reference/7.13/indices-open-close.html">open</a> it again afterwards:</p>
<pre><code class="language-console">POST /index/_close?wait_for_active_shards=0

PUT /index/_settings
{
  &quot;index&quot;: {
    &quot;similarity&quot;: {
      &quot;default&quot;: {
        &quot;type&quot;: &quot;boolean&quot;
      }
    }
  }
}

POST /index/_open
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../elasticSearch/IndexModules/5.Merge.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../../elasticSearch/IndexModules/7.Slowlog.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../elasticSearch/IndexModules/5.Merge.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../../elasticSearch/IndexModules/7.Slowlog.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script type="text/javascript">
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="../../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->


    </body>
</html>
